<!DOCTYPE html>
<html lang="ko " xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>메인dailydiary 메인화면</title>
</head>
<body>
<div>
    <h3>오늘 하루를 기록해보세요.</h3>
    <h1> 한솔이의 일기장 </h1>
</div>

<div class="login-container">
    <h2>로그인</h2>
    <form onsubmit="event.preventDefault();">
        <div class="form-group">
            <input type="email" id="email" name="email" placeholder="email">
        </div>
        <div class="form-group">
            <input type="password" id="password" name="password" placeholder="비밀번호">
        </div>
        <div class="form-group">
            <button type="submit" onclick="login()">로그인</button>
            <button type="#">구글 로그인</button>
            <h3>또는</h3>
        </div>
    </form>

    <input type="hidden" name="userSeq" value=1>
    <button th:onclick="|window.location.href='/register'|">회원가입</button>
    <button th:onclick="|window.location.href='/daily-list/1'|">일기장 임시버튼</button>
</div>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    function login(){
        var email = $("#email").val();
        var password = $("#password").val();

        var formData = new FormData();

        formData.append('email', email);
        formData.append('password', password);

        $.ajax({
            type: "POST",
            url: "/login",
            data: formData,
            processData: false, // FormData 객체 그대로 전송하기 위해 필요
            contentType: false, // FormData 객체 그대로 전송하기 위해 필요
            success: function(result){
                if(result == "success"){
                    alert("로그인 되었습니다.");
                    location.href="/daily-list/1";
                }else{
                    alert("로그인 실패. 다시 입력하세요");
                    window.location.href="/";
                }
            },
            error: function(request,status,error) {
                alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
            }
        });
    }

</script>
</body>
</html>